{
  "displayName": "Group attendance by day - {groupName}",
  "description": "Total counts of how many people attended a group each day.",
  "queries": [
    {
      "depth": 0,
      "keyName": "main",
      "db": "attendance",
      "sqlLines": [
        "SELECT Date(sessionDate) as sessionDate, count(*) as attendees",
        "FROM visitSessions vs",
        "INNER JOIN sessions s on s.id=vs.sessionId",
        "WHERE s.groupId=:groupId",
        "GROUP BY DATE(sessionDate)",
        "ORDER BY DATE(sessionDate)"
      ]
    }
  ],
  "parameters": [
    {
      "keyName": "churchId",
      "source": "au",
      "sourceKey": "churchId"
    },
    {
      "keyName": "groupId",
      "source": "queryString",
      "sourceKey": "groupId"
    }
  ],
  "columns": [
    {
      "header": "Date",
      "value": "main.sessionDate",
      "formatter": "date"
    },
    {
      "header": "Attendees",
      "value": "main.attendees",
      "formatter": "date"
    }
  ],
  "permissions": [
    {
      "apiName": "AccessApi",
      "contentType": "Attendance",
      "action": "View"
    }
  ]
}